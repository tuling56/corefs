##正则笔记
[TOC]

### 基础

#### 元字符

##### 基础

| 元字符 | 说明                         |      |
| ------ | ---------------------------- | ---- |
| .      | .匹配除换行符以外的任意字符  |      |
| \w     | 匹配字母或数字或下划线或汉字 |      |
| \s     | 匹配任意的空白符             |      |
| \d     | 匹配数字                     |      |
| \b     | 匹配单词的开始或结束         |      |
| ^      | 匹配字符串的开始             |      |
| $      | 匹配字符串的结束             |      |

##### 反义

| 元字符    | 说明                                       |      |
| --------- | ------------------------------------------ | ---- |
| \W        | 匹配任意不是字母，数字，下划线，汉字的字符 |      |
| \S        | 匹配任意不是空白的字符                     |      |
| \D        | 匹配任意非数字的字符                       |      |
| \B        | 匹配不是单词开头或结束的位置               |      |
| \[^x]     | 匹配除了x以外的任意字符                    |      |
| \[^aeiou] | 匹配除了aeiou这几个字母以外的任意字符      |      |

#### 重复

##### 基本正则

可以看到基本正则支持[]和{},不需要转义

| 符号             | 意义                                       | 举例                                  |
| -------------- | ---------------------------------------- | ----------------------------------- |
| ^              | 匹配行首                                     | ls  –l \| grep  ^d            匹配文件夹 |
| $              | 匹配行尾                                     | ^$ 匹配所有空行                           |
| .              | 匹配任意单个字符                                 | ^.$只包含一个字符的                         |
| *              | 匹配前一个字符>=0次                              | Compu*t  匹配u重复0或多次                  |
| \              | 屏蔽一个元字符的特殊含义，即转义                         | \\*\.pass 匹配*.pass                  |
| []             | 匹配中括号中出现的字符，可以是单字符或字符序列，可以使用–表范围，注意：在[]中，^代表否定 | 所有单词:[A-Za-z]  非字母:[^A-Za-z]        |
| Pattern\{n\}   | 匹配前面字符出现的次数，n为次数                         | A\{2\}B  匹配AAB                      |
| Pattern\{n,\}  | 至少出现n次                                   | A\{4,\}B  匹配A出现至少4次B                |
| Pattern\{n,m\} | n<=次数 <=m                                | A\{2,4\}B 匹配A出现在2至4次之间              |

##### 扩展正则

- grep需要加-E，或者egrep，或者使用到扩展符号时加\
- sed需要加-r，或者使用到扩展符号时加\
- awk本身支持扩展正则

| 符号   | 意义                              | 举例                    |
| ---- | ------------------------------- | --------------------- |
| +    | 重复一个或一个以上的前一个字符                 | o+代表一个以上的o            |
| ？    | 零个或一个的前一个字符                     | o?代表空或o               |
| \|   | 用或(or)的方式找出数个字符串，两边的字符串不能加额外的空格 | ABC\|DEF表示ABC或DEF     |
| ()   | 找出“组”字符串，[]的引申                  | A(BC\|DE)F表示ABCF或ADEF |



### 进阶

#### 分组

//待补充

#### 断言

断言是Perl正则里才支持的，基本正则和扩展正则都不支持

| 分类   | 代码/语法        | 说明                                       |
| ---- | ------------ | ---------------------------------------- |
| 捕获   | (exp)        | 匹配exp,并捕获文本到自动命名的组里                      |
|      | (?<name>exp) | 匹配exp,并捕获文本到名称为name的组里，也可以写成(?'name'exp) |
|      | (?:exp)      | 匹配exp,不捕获匹配的文本，也不给此分组分配组号                |
| 零宽断言 | (?=exp)      | 匹配exp后面的位置                               |
|      | (?<=exp)     | 匹配exp前面的位置                               |
|      | (?!exp)      | 匹配后面跟的不是exp的位置                           |
|      | (?<!exp)     | 匹配前面不是exp的位置                             |
| 注释   | (?#comment)  | 这种类型的分组不对正则表达式的处理产生任何影响，用于提供注释让人阅读       |

##### (正向)零宽断言

| 代码/语法 | 说明                      | 备注 |
| --------- | ------------------------- | ---- |
| (?=exp)   | 匹配exp后面的位置         |      |
| (?!exp)   | 匹配后面跟的不是exp的位置 |      |
|           |                           |      |

```shell
echo "I'm singing while you're"|grep '\b\w+(?=ing\b)' 
```

##### 负向零宽断言

| 代码/语法 | 说明                  | 备注 |
| --------- | --------------------- | ---- |
| (?<=exp)  | 匹配exp前面的位置     |      |
| (?<!exp)  | 匹配前面不是exp的位置 |      |
|           |                       |      |

#### 平衡组

//待补充

#### 多行模式

##### 单行模式

(开启则“ . ”号会匹配所有字符，不开启则匹配除了换行符之外的所有字符)

而Singleline修饰的是'.'的时候，就是说有Singleline的时候匹配的是所有字符（包括\n），没有Singleline的时候，匹配的是除\n外的所有字符。

```shell

```

##### 多行模式

Multiline修饰的是\^与$，就是说没有Multiline的时候，把\^和$与当作每一行(\n结尾的)的开头和结束来匹配，有Multiline的时候是与整个字符串的开头和结尾匹配;

```shell

```

#### 贪婪和懒惰

在数量限定符之后添加?,代表在能匹配的情况下尽量少匹配

| 代码/语法 | 说明                            |
| --------- | ------------------------------- |
| *?        | 重复任意次，但尽可能少重复      |
| +?        | 重复1次或更多次，但尽可能少重复 |
| ??        | 重复0次或1次，但尽可能少重复    |
| {n,m}?    | 重复n到m次，但尽可能少重复      |
| {n,}?     | 重复n次以上，但尽可能少重复     |

### 积累

#### 常用正则

常用的正则表达式一览

![常用正则](http://p3.pstatp.com/large/pgc-image/153656876071640ac2bf42c)

#### 技巧

##### 提取中文

[awk法](http://bxhsix.blog.hexun.com/71286104_d.html)

```shell
echo "abc周def杰" | awk '{for (i=1; i<=length($1); ++i) if(substr($1,i,1) > "\177") {print substr($1, i, 2) "\t中文"; ++i;} else {print substr($1, i, 1) "\tNot Chinese Character";}}'   
```

##### 匹配换行

匹配任何字符包括换行

```shell
([\s\S]*) 同时，也可以用 ([\d\D]*)、([\w\W]*)来表示
```

 ##参考

- **基础**

  [正则表达式30分钟入门教程](http://www.oschina.net/question/12_9507)

  [正则表达式入门教程（推荐）](http://www.cnblogs.com/deerchao/archive/2006/08/24/zhengzhe30fengzhongjiaocheng.html)

  [Python正则表达式大全](https://www.toutiao.com/i6599513623159112200/)

  [正则表达式教程(强烈推荐)](http://deerchao.net/tutorials/regex/regex.htm)

- **进阶**

  [单行和多行模式](https://www.cnblogs.com/elycir/articles/2351779.html)

- **积累**

  [正则表达式积累(推荐)](https://www.toutiao.com/i6586058272338346500/)

  